<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <!-- viewport-fit=cover is to support iPhone X rounded corners and notch in landscape-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10, viewport-fit=cover">

      <title>LuckyDog | CSUwangj&#x27;s Blog</title>

      <!-- CSS -->
      <link rel="stylesheet" href="https://CSUwangj.github.io/css/lib/font-awesome.min.css">
      <link rel="stylesheet" href="https://CSUwangj.github.io/site.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya+Sans|Noto+Serif+SC">
      
<link rel="stylesheet" href="https://CSUwangj.github.io/custom.css">

      <!-- js -->
      <script type="text/javascript" charset="utf-8" src="https://CSUwangj.github.io/js/sidebar.js"></script>
      

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" crossorigin="anonymous">
<script type="module">
import renderMathInElement from "https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.mjs";
const katex_config = {
  delimiters: [
    { left: "$$", right: "$$", display: true },
    { left: "$", right: "$", display: false },
  ],
  macros: {
    // Functions
    arccot: '\\operatorname{arccot}',
    arcsec: '\\operatorname{arcsec}',
    arccsc: '\\operatorname{arccsc}',
  }
}
renderMathInElement(document.body, katex_config);
</script>


      

      
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
      

      
      
    </head>

    <body>
      
      
        <header name="header">
          <div>
            <div class="logo"><a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;">LuckyDog</a></div>
            <nav class="menu">
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;" class="nav-item-home unselectable">
                  <span><i class="fa-solid fa-house"></i> Home</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;about" class="nav-item-about unselectable">
                  <span><i class="fa-solid fa-user-circle"></i> About</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;categories" class="nav-item-categories unselectable">
                  <span><i class="fa-solid fa-book"></i> Categories</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;tags" class="nav-item-tags unselectable">
                  <span><i class="fa-solid fa-tags"></i> Tags</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;archives" class="nav-item-archives unselectable">
                  <span><i class="fa-solid fa-inbox"></i> Archives</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;ZDaily" class="nav-item-dailychallenge unselectable">
                  <span><i class="fa-solid fa-calendar-check"></i> DailyChallenge</span>
                </a>
              
                <a href="https:&#x2F;&#x2F;CSUwangj.github.io&#x2F;Webtools" class="nav-item-webtools unselectable">
                  <span><i class="fa-solid fa-toolbox"></i> Webtools</span>
                </a>
              
              
            </nav>
          </div>
        </header>
      

      <main class="content container" name="main">
        <div class="content-wrapper">
          
  <div class="post">
    <h1 class="post-title">JarvisOJ-WP合集</h1>
    <div class="post-meta">
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa-solid fa-calendar"></i></span>
        <span class="post-date">Posted on: </span>
        <time datetime=2018-05-10T09:11:00+08:00 title="post created">2018-05-10</time>
      
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa-solid fa-calendar-check"></i></span>
        <span class="modify-date">Posted modified: </span>
        <time datetime=2020-08-07T01:54:43.005696+08:00 title="post modified">2020-08-07</time>
      
      
        <span class="post-meta-divider">|</span>
        <span class="post-meta-item-icon"><i class="fa-solid fa-folder"></i></span>
        <span class="in-category">In: </span>
          
            <a class="category" href="/category/WriteUp">WriteUp</a>
          
      
      <span class="post-meta-divider">|</span>
    </div>
    <div class="post-body">
      <p>因为预感进度表会很长，所以不放了</p>
<span id="continue-reading"></span><h1 id="bu-zi-ci-tiao-zhuan-de-jin-du-biao">不资瓷跳转的进度表</h1>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Basic
<ul>
<li><input disabled="" type="checkbox" checked=""/>
base64</li>
<li><input disabled="" type="checkbox" checked=""/>
关于USS Lab.</li>
<li><input disabled="" type="checkbox" checked=""/>
veryeasy</li>
<li><input disabled="" type="checkbox" checked=""/>
段子</li>
<li><input disabled="" type="checkbox" checked=""/>
手贱</li>
<li><input disabled="" type="checkbox" checked=""/>
美丽的实验室logo</li>
<li><input disabled="" type="checkbox" checked=""/>
神秘的文件</li>
<li><input disabled="" type="checkbox" checked=""/>
公倍数</li>
<li><input disabled="" type="checkbox" checked=""/>
Easy Crackme</li>
<li><input disabled="" type="checkbox" checked=""/>
Secret</li>
<li><input disabled="" type="checkbox" checked=""/>
爱吃培根的出题人</li>
<li><input disabled="" type="checkbox" checked=""/>
Easy RSA</li>
<li><input disabled="" type="checkbox" checked=""/>
ROPGadget</li>
<li><input disabled="" type="checkbox" checked=""/>
取证</li>
<li><input disabled="" type="checkbox" checked=""/>
熟悉的声音</li>
<li><input disabled="" type="checkbox" checked=""/>
Baby's Crack</li>
<li><input disabled="" type="checkbox" checked=""/>
Help!!</li>
<li><input disabled="" type="checkbox" checked=""/>
Shellcode</li>
<li><input disabled="" type="checkbox" checked=""/>
A Piece Of Cake</li>
<li><input disabled="" type="checkbox" checked=""/>
-.-字符串</li>
<li><input disabled="" type="checkbox" checked=""/>
德军的密码</li>
<li><input disabled="" type="checkbox" checked=""/>
握手包</li>
</ul>
</li>
<li><input disabled="" type="checkbox" checked=""/>
Crypto
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Medium RSA</li>
<li><input disabled="" type="checkbox"/>
BrokenPic</li>
<li><input disabled="" type="checkbox" checked=""/>
hard RSA</li>
</ul>
</li>
</ul>
<h1 id="x-basic">[Ｘ] Basic</h1>
<h2 id="x-base64">[Ｘ] base64</h2>
<p>注意到没有小写字母和大点的数字，猜测是base32，解完以后是一个十六进制字符串，转ASCII解得</p>
<h3 id="flag">flag</h3>
<p>PCTF{Just_t3st_h4v3_f4n}</p>
<h2 id="x-guan-yu-uss-lab">[Ｘ] 关于USS Lab.</h2>
<p>搜索得到答案，注意题目里说的是USS Lab。</p>
<p>顺便其实点开about就能看到全称（233</p>
<h3 id="flag-1">flag</h3>
<p>PCTF{ubiquitous_system_security}</p>
<h2 id="x-veryeasy">[Ｘ] veryeasy</h2>
<p>打开文件我就知道要用strings命令，但是我就不，我就翻</p>
<h3 id="flag-2">flag</h3>
<p>PCTF{strings_i5_3asy_isnt_i7}</p>
<h2 id="x-duan-zi">[Ｘ] 段子</h2>
<p>将锟斤拷存ANSI编码，然后HEX编辑器打开就好</p>
<h3 id="flag-3">flag</h3>
<p>PCTF{EFBFBDEFBFBD}</p>
<h2 id="x-shou-jian">[Ｘ] 手贱</h2>
<p>直接解MD5，然后发现说不是标准MD5值，发现长度为33</p>
<p>再看看具体的，发现里面有个$L$的小写，删了解MD5得flag</p>
<h3 id="flag-4">flag</h3>
<p>PCTF{hack}</p>
<h2 id="x-mei-li-de-shi-yan-shi-logo">[Ｘ] 美丽的实验室logo</h2>
<p>binwalk没有额外东西</p>
<p>但是可以发现不是裸的jpg，strings可以看到Adobe公司工具编辑的痕迹，回去继续</p>
<hr />
<p>不对，用Stegsolver的Frame Browser看到了flag</p>
<h3 id="flag-5">flag</h3>
<p>PCTF{You_are_R3ally_Car3ful}</p>
<h2 id="x-veryeasyrsa">[Ｘ] veryeasyRSA</h2>
<p>RSA-tool直接上啦~</p>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525919629975.png" alt="veryeasyRSA" /></p>
<h3 id="flag-6">flag</h3>
<p>PCTF{19178568796155560423675975774142829153827883709027717723363077606260717434369}</p>
<h2 id="x-shen-mi-de-wen-jian">[Ｘ] 神秘的文件</h2>
<p>file/binwalk指令得到这是一个exT文件系统数据，strings结果也奇怪</p>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525920969858.png" alt="神秘的文件" /></p>
<p>索性打开文件看，发现有一堆\x00</p>
<p>但是往下翻发现有些其他东西</p>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525921057979.png" alt="神秘的文件_2" /></p>
<p>然后找到P/C/T，想着能不能移除<code>\x00</code>得到flag</p>
<p>然后的确得到了，但是结果失败了</p>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525922016986.png" alt="神秘的文件_3" /></p>
<p>因为错位包括前后错位，所以直接拼凑也是会失败的</p>
<p>看来还是需要文件系统，用命令</p>
<p><code>mount -o loop haha.f38a74f55b4e193561d1b707211cf7eb /mnt</code></p>
<p>装载文件系统之后，发现每个文件里一个字符，所以写出脚本</p>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">import os
s = &quot;&quot;
for i in range(0, 254):
	f = open(str(i), &quot;r&quot;)
	s += f.read()
	f.close()
print(s)
</code></pre>
<p>得到flag</p>
<h3 id="flag-7">flag</h3>
<p>PCTF{P13c3_7oghter_i7}</p>
<h2 id="x-gong-bei-shu">[Ｘ] 公倍数</h2>
<p>1s大概做1e8的计算，所以可以直接暴力算就好</p>
<p>代码就没必要放了吧~</p>
<h3 id="flag-8">flag</h3>
<p>PCTF{233333333166666668}</p>
<h2 id="x-easy-crackme">[Ｘ] Easy Crackme</h2>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525966589251.png" alt="Easy Crackme" /></p>
<p>算法很简单，第一位异或以后，后面24位每6位一组和对应位置异或，然后进行比较</p>
<p>写出逆算法</p>
<pre data-lang="cpp" class="language-cpp "><code class="language-cpp" data-lang="cpp">#include &lt;bits&#x2F;stdc++.h&gt;
using namespace std;
unsigned char a[27] = {
    0xFB, 0x9E, 0x67, 0x12, 0x4E, 0x9D, 0x98, 0xAB, 0x00, 0x06, 0x46, 0x8A, 0xF4, 0xB4, 0x06, 0x0B,
    0x43, 0xDC, 0xD9, 0xA4, 0x6C, 0x31, 0x74, 0x9C, 0xD2, 0xA0, 0
};
int ar[6] = {-35,51,84,53,-17,-85};
int main()
{
	a[0]^=0xab;
	for(int i=0;i&lt;25;++i){
		a[i+1]^=ar[i%6];
	}
	puts((const char *)a);
    return 0;
}

</code></pre>
<h3 id="flag-9">flag</h3>
<p>PCTF{r3v3Rse_i5_v3ry_eAsy}</p>
<h2 id="x-secret">[Ｘ]  Secret</h2>
<p>打开，F12，网络，刷新，得到</p>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525960605970.png" alt="Secret" /></p>
<h3 id="flag-10">flag</h3>
<p>PCTF{Welcome_to_phrackCTF_2016}</p>
<h2 id="x-ai-chi-pei-gen-de-chu-ti-ren">[Ｘ]  爱吃培根的出题人</h2>
<p>提示够明显了，小写字母-&gt;A，大写字母-&gt;B，<a rel="noopener nofollow noreferrer" target="_blank" href="https://mothereff.in/bacon">培根密码解密</a></p>
<h3 id="flag-11">flag</h3>
<h2 id="x-easy-rsa">[Ｘ] Easy RSA</h2>
<p>提示明显</p>
<h3 id="flag-12">flag</h3>
<p>PCTF{3a5Y}</p>
<h2 id="x-ropgadget">[Ｘ] ROPGadget</h2>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525961626864.png" alt="ROPGadget" /></p>
<h3 id="flag-13">flag</h3>
<p>PCTF{94C38B08890A5BC3}</p>
<h2 id="x-qu-zheng">[Ｘ] 取证</h2>
<p>搜索得软件名Volatility</p>
<h3 id="flag-14">flag</h3>
<p>PCTF{volatility}</p>
<h2 id="x-shou-xi-de-sheng-yin">[Ｘ] 熟悉的声音</h2>
<p>摩尔斯-&gt;凯撒</p>
<h3 id="flag-15">flag</h3>
<p>PCTF{PHRACKCTF}</p>
<h2 id="x-baby-s-crack">[Ｘ] Baby's Crack</h2>
<p>很简单的加密，都不用写逆算法了，直接爆破吧！</p>
<pre data-lang="c" class="language-c "><code class="language-c" data-lang="c">#include &lt;string.h&gt;
#include &lt;stdio.h&gt;
char a[] = &quot;jeihjiiklwjnk{ljj{kflghhj{ilk{k{kij{ihlgkfkhkwhhjgly&quot;;
char b[] = &quot;jeihjiiklwjnk{ljj{kflghhj{ilk{k{kij{ihlgkfkhkwhhjgly&quot;;&#x2F;&#x2F;这里可以为空，我只是方便设置长度搞得
int main()
{
	int len = strlen(a);
	for(int i=0;i&lt;len;++i){
		int ok = 0;
		for(int j=32;j&lt;255&amp;&amp;!ok;++j){
			int cur = j;
			if ( j &gt; 47 &amp;&amp; j &lt;= 96 ){
          		j += 53;
        	}else if ( j &lt;= 46 ){
          		j += j % 11;
        	}else{
          		j = 61 * (j &#x2F; 61);
        	}
        	if(j==a[i]){
        		&#x2F;&#x2F;ok=1;这里加上注释是为了确认每次解的唯一
        		b[i]=cur;
        		putchar(cur);
        	}
        	j=cur;
        }
        putchar(&#x27;\n&#x27;);
    }
    puts(b);
	return 0;
}
</code></pre>
<p>得到的结果转ASCII就好</p>
<h3 id="flag-16">flag</h3>
<p>PCTF{You_ar3_Good_Crack3R}</p>
<h2 id="x-help">[Ｘ] Help!!</h2>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525968750571.png" alt="Help!!" /></p>
<p>打开word没有发现flag，binwalk/strings也没有</p>
<p>于是解压word，发现有两张图，OK</p>
<h3 id="flag-17">flag</h3>
<p>PCTF{You_Know_moR3_4boUt_woRd}</p>
<h2 id="x-shellcode">[Ｘ] Shellcode</h2>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525973282058.png" alt="Shellcode" /></p>
<h3 id="flag-18">flag</h3>
<p>PCTF{Begin_4_good_pwnn3r}</p>
<h2 id="x-a-piece-of-cake">[Ｘ] A Piece Of Cake</h2>
<p>一眼就看出来是单表替换，quip解决</p>
<h3 id="flag-19">flag</h3>
<p>PCTF{substitutepassisveryeasyyougotit}</p>
<h2 id="x-zi-fu-chuan">[Ｘ] -.-字符串</h2>
<p>一目了然</p>
<h3 id="flag-20">flag</h3>
<p>522018D665387D1DA931812B77763410</p>
<h2 id="x-de-jun-de-mi-ma">[Ｘ] 德军的密码</h2>
<p><img src="https://CSUwangj.github.io/jarvisoj-wphe-ji/1525970989136.png" alt="德军的密码" /></p>
<p>然后解得flag</p>
<h3 id="flag-21">flag</h3>
<p>WELCOMECISRG</p>
<h2 id="x-wo-shou-bao">[Ｘ] 握手包</h2>
<p>下载发现是个cap包，中文搜索无果，搜&quot;Kali handshake crack&quot;，搜到hashcat，找到<a rel="noopener nofollow noreferrer" target="_blank" href="https://hashcat.net/wiki/doku.php?id=cracking_wpawpa2">这个网站</a></p>
<p>照葫芦画瓢</p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">A:\Downloads\Compressed\hashcat-4.1.0
λ hashcat64.exe -m 2500 9640_1525972232.hccapx rockyou.txt
hashcat (v4.1.0) starting...

* Device #1: WARNING! Kernel exec timeout is not disabled.
             This may cause &quot;CL_OUT_OF_RESOURCES&quot; or related errors.
             To disable the timeout, see: https:&#x2F;&#x2F;hashcat.net&#x2F;q&#x2F;timeoutpatch
* Device #2: Intel&#x27;s OpenCL runtime (GPU only) is currently broken.
             We are waiting for updated OpenCL drivers from Intel.
             You can use --force to override, but do not report related errors.
nvmlDeviceGetFanSpeed(): Not Supported

OpenCL Platform #1: NVIDIA Corporation
======================================
* Device #1: GeForce GTX 965M, 512&#x2F;2048 MB allocatable, 8MCU

OpenCL Platform #2: Intel(R) Corporation
========================================
* Device #2: Intel(R) HD Graphics 530, skipped.
* Device #3: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz, skipped.

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5&#x2F;13 rotates
Rules: 1

Applicable optimizers:
* Zero-Byte
* Single-Hash
* Single-Salt
* Slow-Hash-SIMD-LOOP

Minimum password length supported by kernel: 8
Maximum password length supported by kernel: 63

Watchdog: Temperature abort trigger set to 90c

Dictionary cache built:
* Filename..: rockyou.txt
* Passwords.: 14344390
* Bytes.....: 139921496
* Keyspace..: 14344383
* Runtime...: 3 secs

e56452df7244988624af174fa692d81d:560a64ffe917:b8ee65ac640b:Flag_is_here:11223344

Session..........: hashcat
Status...........: Cracked
Hash.Type........: WPA&#x2F;WPA2
Hash.Target......: Flag_is_here (AP:56:0a:64:ff:e9:17 STA:b8:ee:65:ac:64:0b)
Time.Started.....: Fri May 11 01:17:21 2018 (3 secs)
Time.Estimated...: Fri May 11 01:17:24 2018 (0 secs)
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1&#x2F;1 (100.00%)
Speed.Dev.#1.....:    91621 H&#x2F;s (10.79ms) @ Accel:32 Loops:16 Thr:1024 Vec:1
Recovered........: 1&#x2F;1 (100.00%) Digests, 1&#x2F;1 (100.00%) Salts
Progress.........: 593466&#x2F;14344383 (4.14%)
Rejected.........: 331322&#x2F;593466 (55.83%)
Restore.Point....: 0&#x2F;14344383 (0.00%)
Candidates.#1....: 123456789 -&gt; rinabelle
HWMon.Dev.#1.....: Temp: 68c Util: 98% Core:1151MHz Mem:2505MHz Bus:16

Started: Fri May 11 01:17:04 2018
Stopped: Fri May 11 01:17:25 2018
</code></pre>
<h3 id="flag-22">flag</h3>
<p>flag{11223344}</p>
<h1 id="crypto">[　] Crypto</h1>
<h2 id="x-medium-rsa">[Ｘ] Medium RSA</h2>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">λ openssl rsa -pubin -in pubkey.pem -text -modulus
WARNING: can&#x27;t open config file: &#x2F;usr&#x2F;local&#x2F;ssl&#x2F;openssl.cnf
Public-Key: (256 bit)
Modulus:
    00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f:
    1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f:
    be:30:dd
Exponent: 65537 (0x10001)
Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD
writing RSA key
-----BEGIN PUBLIC KEY-----
MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMJjauXD2OQ&#x2F;+5erCQKPGqxsC&#x2F;bNPXDr
yigb&#x2F;+l&#x2F;vjDdAgMBAAE=
-----END PUBLIC KEY-----

</code></pre>
<p>然后分解这个数，用RSAtools输出私钥文件</p>
<pre data-lang="bash" class="language-bash "><code class="language-bash" data-lang="bash">λ python rsatool.py -f PEM -o key.pem -p 275127860351348928173285174381581152299 -q 319576316814478949870590164193048 041239
Using (p, q) to initialise RSA instance

n =
c2636ae5c3d8e43ffb97ab09028f1aac6c0bf6cd3d70ebca281bffe97fbe30dd

e = 65537 (0x10001)

d =
1806799bd44ce649122b78b43060c786f8b77fb1593e0842da063ba0d8728bf1

p = 275127860351348928173285174381581152299 (0xcefbb2cf7e18a98ebedc36e3e7c3b02b)

q = 319576316814478949870590164193048041239 (0xf06c28e91c8922b9c236e23560c09717)

Saving PEM as key.pem
</code></pre>
<p>之后解密</p>
<p><code>λ openssl rsautl -decrypt -inkey key.pem -in flag.enc -out flag</code></p>
<h3 id="flag-23">flag</h3>
<p>PCTF{256b_i5_m3dium}</p>
<h2 id="brokenpic">[　] BrokenPic</h2>
<h3 id="flag-24">flag</h3>
<h2 id="x-hard-rsa">[Ｘ] hard RSA</h2>
<h2 id="rsa-yan-sheng-suan-fa-rabin-suan-fa">RSA 衍生算法——Rabin 算法</h2>
<h3 id="gong-ji-tiao-jian">攻击条件</h3>
<p>Rabin 算法的特征在于 $e=2​$。</p>
<h3 id="gong-ji-yuan-li">攻击原理</h3>
<blockquote>
<p>密文：</p>
<p>$c=m^2\mod n$</p>
<p>解密：</p>
<ul>
<li>计算出 $m^p$ 和 $m^q$：</li>
</ul>
<p>$$m_p=\sqrt{c}\mod p$$</p>
<p>$$m_q=\sqrt{c}\mod q$$</p>
<ul>
<li>用扩展欧几里得计算出 $y_p$ 和 $y_q$：</li>
</ul>
<p>$y_p⋅p+y_q⋅q=1$</p>
<ul>
<li>解出四个明文：</li>
</ul>
<p>$$a=(y_p⋅p⋅m_q+y_q⋅q⋅m_p)modn$$</p>
<p>$$b=n−a$$</p>
<p>$$c=(y_p⋅p⋅m_q−y_q⋅q⋅m_p)modn$$</p>
<p>$$d=n−c$$</p>
<p>注意：如果 $$p≡q≡3(mod4)$$，则</p>
<p>$$mp=c^{\frac{1}{4}(p+1)}modp$$</p>
<p>$$mq=c^{\frac14(q+1)}modq$$</p>
<p>而一般情况下，$p≡q≡3(mod4)p $是满足的，对于不满足的情况下，请参考相应的算法解决。</p>
</blockquote>
<pre data-lang="python" class="language-python "><code class="language-python" data-lang="python">#!&#x2F;usr&#x2F;bin&#x2F;python
# coding=utf-8
import gmpy2
import string
from Crypto.PublicKey import RSA

# 读取公钥参数
with open(&#x27;pubkey.pem&#x27;, &#x27;r&#x27;) as f:
    key = RSA.importKey(f)
    N = key.n
    e = key.e
with open(&#x27;flag.enc&#x27;, &#x27;r&#x27;) as f:
    cipher = f.read().encode(&#x27;hex&#x27;)
    cipher = string.atoi(cipher, base=16)
    # print cipher
print &quot;please input p&quot;
p = int(raw_input(), 10)
print &#x27;please input q&#x27;
q = int(raw_input(), 10)
# 计算yp和yq
inv_p = gmpy2.invert(p, q)
inv_q = gmpy2.invert(q, p)

# 计算mp和mq
mp = pow(cipher, (p + 1) &#x2F; 4, p)
mq = pow(cipher, (q + 1) &#x2F; 4, q)

# 计算a,b,c,d
a = (inv_p * p * mq + inv_q * q * mp) % N
b = N - int(a)
c = (inv_p * p * mq - inv_q * q * mp) % N
d = N - int(c)

for i in (a, b, c, d):
    s = &#x27;%x&#x27; % i
    if len(s) % 2 != 0:
        s = &#x27;0&#x27; + s
    print s.decode(&#x27;hex&#x27;)
</code></pre>
<h3 id="flag-25">flag</h3>
<p>PCTF{sp3ci4l_rsa}</p>

    </div>
  </div>

        </div>

        
          <button class="sidebar-toggle" onclick="openSidebar()">O</button>
          <aside class="sidebar" name="sidebar">
            <div class="site-author" itemprop="author" itemtype="https://schema.org/Person">
              
              <img class="site-author-image" itemprop="image"
                src="https://CSUwangj.github.io/images/avatar.png"
                alt="CSUwangj" />
              
              <p class="site-author-name unselectable">CSUwangj</p>
              <p class="site-author-quote">Just keep in mind that hacking is very rarely in a sequence.</p>
            </div>
            <div class="feed-link">
              
                <a rel="alternate" type="application/atom+xml" title="RSS" href="https://CSUwangj.github.io/atom.xml">
                  RSS
                </a>
              
            </div>
            <div class="links-of-author">
              
                <a href="https:&#x2F;&#x2F;github.com&#x2F;CSUwangj" title="Github" class="author-link">
                  <i class="fa fw fa-github"></i>
                </a>
              
                <a href="mailto:CSUwangj@protonmail.com" title="EMail" class="author-link">
                  <i class="fa fw fa-envelope"></i>
                </a>
              
            </div>
            <div class="links-of-blogroll">
              
                <a href="https:&#x2F;&#x2F;wolfbolin.com&#x2F;">WolfBolin</a>
              
                <a href="https:&#x2F;&#x2F;haolovej.com&#x2F;">bocity</a>
              
                <a href="https:&#x2F;&#x2F;blog.yuki-nagato.com&#x2F;">长门有希</a>
              
                <a href="http:&#x2F;&#x2F;www.porlockz.com&#x2F;">Porlockz</a>
              
                <a href="https:&#x2F;&#x2F;way.lu&#x2F;">Phodphorus</a>
              
                <a href="https:&#x2F;&#x2F;zickshen.github.io&#x2F;">ZickShen</a>
              
            </div>
          </aside>
        

      </main>

      
        <footer name="footer">
          <div class="copyright">
            <span item="copyrightYear">© 2018-2022</span>
            <span class="author">CSUwangj</span>
          </div>
          <div class="powered-by">
            Powered by <a href="https://www.getzola.org/">Zola</a> Theme <a href="https://github.com/CSUwangj/DogFood">DogFood</a>
          </div>
        </footer>
      
    </body>

</html>